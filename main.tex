% N.B. : Assurez-vous de compiler ce fichier en employant "pdflatex" afin que les images soient incluses.

% Tout commentaire est bienvenu et devrait être adressé à "support@dms.umontreal.ca".

\documentclass[12pt,maitrise,nobabel,anglais,twoside]{template/dms} 
% La commande précédente charge la classe "dms.cls" avec les options suivantes : 
%   -police de caractères en 12 pts 
%   -format adapté à une thèse de doctorat 
%   -écriture en anglais
%   -impression recto-verso.
%   -adapté pour le dépôt initial (enlever l'option pour le dépôt final)
%
% Modifiez cette commande selon vos besoin à l'aide des options suivants :
% maitrise			mémoire de maîtrise;
% phd				thèse de doctorat;
% phdart                        thèse de doctorat par articles;
% rapport			rapport de stage;
% travaildirige			travail dirigé;
% oneside			impression recto;
% twoside			impression recto-verso.
% initial			depot initial (sans l'option pour depot final)
% policeTNR                     pour utiliser (l'équivalent de) Times New Roman (sinon <lmodern> est chargé, la fonte par défaut)
% nobabel=anglais		document en anglais seulement
% frenchb			document en français
% frenchb,english		document en français contenant de l'anglais (utiliser \selectlanguage{} )

%\usepackage[utf8]{inputenc}		% Déjà chargés dans la classe
%\usepackage[T1]{fontenc}

\usepackage[canadian]{babel}  %Equivalent to USenglish.  As options, there are also : british, australian, newzealand
\usepackage{standalone}
\usepackage{natbib}
\usepackage{algorithm,algpseudocode}



% La commande \sloppy peut avoir des effets étranges sur les
% lignes de certains paragraphes.  Dans ce cas, essayez \fussy
% qui suppresse les effets de \sloppy. (\fussy est le comportement par défaut.)
% On redéfinit \sloppy, pour tenter de réduire les comportements étranges.  
% Le seul changement apporté à la version originale est la valeur de \tolerance.
\def\sloppy{%
  \tolerance 500%  %9999 dans LaTeX ordinaire, mauvaise idée.
  \emergencystretch 3em%
  \hfuzz .5\csname p@\endcsname
  \vfuzz\hfuzz}
\sloppy  



\usepackage{graphicx,amsmath,amsfonts,amssymb,setspace,subfigure,color,dsfont}
% graphicx		Pour importer des images (PDF, JPG, PNG).
% amsmath		Écriture selon les normes de l'AMS.
% amsfonts		Fontes additionnelles de l'AMS.
% amssymb		Écriture des symbols de l'AMS.
% setspace		Permet de régler la distance interligne dans le document.
% subfigure		Simplifie l'inclusion de figures côtes-\`a-côtes.
% color			Pour l'utilisation de couleurs dans le texte.
% icomma		Reconnait la virgule comme caractère mathematique de facon intelligent
% dsfont		symboles mathématiques


\usepackage[pdfpagemode=UseNone,pdfstartview={XYZ null null null}]{hyperref}	% Cette extension permet l'insertion d'hyperliens dans votre document pdf.
 \definecolor{dark-red}{rgb}{0.4,0.15,0.15}					% Ici, trois couleurs sont définies et seront utilisées pour colorer les "hyperliens".
 \definecolor{dark-blue}{rgb}{0.15,0.15,0.4}
 \definecolor{medium-blue}{rgb}{0,0,0.5}
 \hypersetup{colorlinks,linkcolor={dark-red},citecolor={dark-blue},urlcolor={medium-blue}}
\usepackage{bookmark}  % Remédie à des petits problème de <hyperref> (important qu'il soit chargé après <hyperref>)
  % Enlever les commentaires et remplir cette section avec l'information pertinente.
  % Ceci ajoute des « méta-données » au pdf.  C'est optionnel, mais recommandé.
  % Vous pouvez voir ces méta-données en ouvrant un visionneur de pdf et en cherchant les
  % propriétés du pdf.  (Vous pouvez aussi tapez ' pdfinfo <nom-du-pdf> '  dans un terminal.)
  % Ces données sont utiles, par exemple, pour augmenter les chances qu'un algorithme de
  % recherche trouve votre document sur Internet, une fois diffusé.  Autrement dit, ceci
  % peut aider à augmenter la visibilité de votre travail.
%\hypersetup{
%    pdftitle = {Exemple d'une thèse}, 
%    pdfauthor = {Coadmin},
%    pdfsubject = {Exemple pour utiliser le gabarit du DMS},
%    pdfkeywords = {DMS, gabarit, exemple, thèse, mémoire, coadministrateur}
%}

% Numérotation des équations par section et numérotation des tableaux et figures par chapitre.
\numberwithin{equation}{section}
\numberwithin{table}{chapter}
\numberwithin{figure}{chapter}

% Définition des environnements utiles pour un mémoire scientifique.
% 1	%EN
\newtheorem{corollary}{Corollary}[chapter] %[section]
\newtheorem{definition}{Definition}[chapter] %[section]
\newtheorem{example}{Example}[chapter] %[section]
\newtheorem{lemma}{Lemma}[chapter] %[section]
\newtheorem{proposition}{Proposition}[chapter] %[section]
\newtheorem{remark}{Remark}[chapter] %[section]
\newtheorem{theorem}{Theorem}[chapter] %[section]


% Si vous préférez que les corollaires, definitions, théor\`emes, etc. soient numérotés par le même compteur, utilisez plutôt ce bloc de commandes : 
%2	% EN
%\newtheorem{corollary}{Corollary}[section] 
%\newtheorem{definition}[corollary]{Definition}
%\newtheorem{example}[corollary]{Example}
%\newtheorem{lemma}[corollary]{Lemma}
%\newtheorem{proposition}[corollary]{Proposition}
%\newtheorem{remark}[corollary]{Remark}
%\newtheorem{theorem}[corollary]{Theorem}


\onehalfspacing				% Fixe la distance interligne \`a "1.5". Pour une interligne double, utilisez plutôt "\doublespacing".

\allowdisplaybreaks			% Cette commande autorise LaTeX \`a briser les blocs d'équations, permettant ainsi une couverture plus uniforme des pages.


%
% ---------  D É B U T  D U  D O C U M E N T  ---------
%

%Commande pour numéroter les tableaux en chiffres romains (préfixe: le numéro du chapitre)
\renewcommand{\thetable}{\thechapter. \Roman{table}}

\begin{document}

% La commande "\brouillon" imprime, au bas de chaque page, la date ainsi que l'heure de la derni\`ere compilation de votre fichier.
%\brouillon            

% Voici les variables pour la création de votre page titre.

\title{Factorized second order methods in neural networks}
\author{Thomas George}
\copyrightyear{2017}
\date{August 31, 2017}									% Date de dépôt du document.
	% ces éléments ne doivent plus apparaittre selon les dierectives de la FESP
	% si toutefois vou souhaitez les inclure, il faudra aussi modifier le document dms.cls
% \president{Nom du président du jury}
% \directeur{Nom du directeur de recherche}
% \codirecteur{Nom du codirecteur}
% \membrejury{Nom du membre du jury} 
% \examinateur{Nom de l'examinateur externe}
% %\membresjury{alpha, beta, gamma}
% %\plusmembresjury{psi, zeta, omega} 
% \repdoyen{Nom du représentant du doyen} 
\dateacceptation{Date d'acceptation}
\sujet{informatique}							% Votre discipline de recherche, soit "mathématiques" ou "statistique".
%\orientation{mathématiques fondamentales}		% Cette commande est optionnelle. Les choix courants sont : "mathématiques fondamentales", "mathématiques de l'ingénieur" et "mathématiques appliquées".

\department{D\'epartement d'informatique et de recherche opérationnelle}

% Fin des variables \`a définir. La commande "\maketitle" créera votre page titre.


\pagenumbering{roman}
\maketitle    
 
\chapter*{Sommaire} 	% La commande "\chapter*" crée un chapitre sans numéro, contrairement \`a la commande "\chapter" réguli\`ere.

\noindent Les méthodes d'optimisation de premier ordre (descente de gradient) ont permis d'obtenir des succès impressionnants pour entrainer des réseaux de neurones artificiels. Les méthodes de second ordre permettent en théorie d'accélérer l'optimisation d'une fonction, mais dans le cas des réseaux de neurones le nombre de variables est bien trop important. Dans ce mémoire de maitrise, je présente les méthodes de second ordre habituellement appliquées en optimisation, ainsi que des méthodes approchées qui permettent de les appliquer aux réseaux de neurones profonds. J'introduis un nouvel algorithme basé sur une approximation des méthodes de second ordre, et je valide empiriquement qu'il présente un intérêt pratique. J'introduis aussi une modification de l'algorithme de rétropropagation du gradient, utilisé pour calculer efficacement les gradients nécessaires aux méthodes d'optimisation.

\textbf{Mots-clés}: Apprentissage automatique, apprentissage profond, optimisation, second ordre, gradient naturel

\chapter*{Summary}

\noindent First order optimization methods (gradient descent) have enabled impressive successes for training artificial neural networks. Second order methods theoretically allow accelerating optimization of functions, but in the case of neural networks the number of variables is far too big. In this master's thesis, I present usual second order methods, as well as approximate methods that allow applying them to deep neural networks. I introduce a new algorithm based on an approximation of second order methods, and I experimentally show that it is of practical interest. I also introduce a modification of the backpropagation algorithm, used to efficiently compute the gradients required in optimization.

\textbf{Keywords}: Machine learning, deep learning, optimization, second order, natural gradient

% TABLE DES MATIÈRES
\cleardoublepage
\pdfbookmark[chapter]{\contentsname}{toc}  %Crée un bouton sur la bar de navigation
\tableofcontents				% Table des mati\`eres.
% LISTE DES TABLEAUX
\cleardoublepage
\phantomsection
\listoftables
% LISTE DES FIGURES
\cleardoublepage
\phantomsection
\listoffigures	


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% LISTE DES SIGLES ET ABRÉVIATION %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Il est obligatoire, selon les directives de la FESP, 
%% pour une thèse ou un mémoire d'avoir une liste des sigles et 
%% des abréviations.  Si vous considérez que de telles listes ne seraient pas
%% pertinentes (si, par exemple, vous n'utilisez aucun sigle ou abré.), son
%% inclusion ou omission est laissé à votre discrétion.  En cas de doute,
%% parlez-en à votre directeur de recherche, le coadministrateur ou, ultimement, à
%% la FESP directement.
%%
%% Dans le cas où vous incluez une table des sigles et des abréviations,
%% vous pouvez enlever les % de la section suivante pour faire apparaître
%% un exemple d'une telle liste « fait à la main ».  Il existe des outils
%% plus sophistiqués si vous devez inclure une multitude de sigles et abréviations.
%% (Par exemple, le package <glossaries> peut faire des index élaborés.  Comme
%% son utilisation est technique, il n'y a pas d'exemple directement dans ce gabarit.
%% On invite les gens qui aurait à l'utiliser à consulter le wiki
%% du dms, le coadministrateur ou faire leur propre recherche.)

\chapter*{List of acronyms and abbreviations}
\begingroup %Pour que le \renewcommand soit local
%%Modifiez ce nombre (p.ex.remplacez 2 par 1.5) pour augmenter ou diminuer l'espace entre les lignes du tableau.
\renewcommand{\arraystretch}{2} 
\noindent\begin{tabular}{p{.2\textwidth} p{.7\textwidth}}
  ACP & Amortized Covariance Preconditioner (section \ref{subsec:Amortized-covariance-preconditio})\\
  FIM & Fisher Information Matrix (section \ref{subsec:Fisher-Information-Matrix})\\
  GN  &  Gauss-Newton approximate Hessian matrix (section \ref{subsec:gauss-newton})\\
  GPU & Graphics Processing Unit\\
  KFAC & Kronecker Factored Approximate Curvature (section \ref{subsec:KFAC})\\
  MLP  & Multilayer Perceptron (section \ref{subsec:Multilayer-perceptron}) \\
  SGD  &  Stochastic Gradient Descent (section \ref{sec:Stochastic-gradient-descent})\\
  UBP & Updated Backpropagation (section \ref{sec:Updated-backpropagation-algorith})\\

\end{tabular}
     \endgroup  %Fin du groupe local pour \arraystretch


\chapter*{Remerciements} %Remerciements

Passer ses journées à étudier, apprendre et explorer un sujet aussi passionant que l'intelligence artificielle est une chance. Celle-ci nous a été rendu possible, et à moi aussi, par des milliers d'années de construction d'une civilisation humaine et de savoirs scientifiques. Tous les acteurs de ces constructions, illustres et inconnus, sont à remercier. 

De manière plus prosaïque je souhaite remercier le Québec et tous les québécois que j'ai rencontré pendant ces 2 dernières années, qui m'ont accueilli dans cette étonnante ville de Montréal: Merci. 

À mes proches, famille et amis, à qui j'ai parfois eu beaucoup de mal à expliquer à quoi j'occupais mes journées. Pour leur regard extérieur souvent circonspect, mais surtout pour les bons moments passés: Merci.

Aux membres du jury qui s'apprêtent à prendre connaissance du fruit de mon travail: Merci.

Aux étudiants et professeurs du MILA, et en particulier César toujours présent pour discuter d'une nouvelle idée et l'implémenter à n'importe quelle heure de la nuit pendant les semaines de deadline: Merci. 

À Pascal Vincent qui m'a supervisé dans ce travail de recherche, tout en me donnant les clés pour débloquer les situations où j'avais déjà retourné le problème dans tous les sens: Merci.

Et merci à Lisa bien sûr... pas le laboratoire !

% Fin des pages liminaires. À partir d'ici, les premi\`eres pages des chapitres ne doivent pas être numérotées.

% Voici maintenant le chapitre d'introduction.
\NoChapterPageNumber 
\cleardoublepage

\pagenumbering{arabic}


\chapter*{Introduction}
\pagenumbering{arabic}

\input{intro}



\

\input{master}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%   BIBLIOGRAPHIE                  %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  % Enlever les commentaires de la prochaine commande si vous préférez que le
  % chapitre s'appelle « Références » plutôt que « Bibliographie » (au choix selon le contexte).
%\let\bibname=\refname   

%% Lorsque vous serez prêt à faire afficher votre bibliographie
%% et vos références, enlevez les commandaires des commandes suivantes
%% et donnez le nom de votre fichier .bib à la commande \bibliography{..}
%% (consultez l'exemple au besoin).  Vous pouvez utiliser le style de votre
%% choix.  Le fichier francaissc.bst est inclus avec le gabarit.  Vous pouvez
%% utiliser ce style avec  \bibliographystyle{francaissc}
% 
\bibliographystyle{plainnat}		    % Le style de la bibliographie. Notons que les extensions ne sont pas données pour ces deux fichiers.
\bibliography{biblio}		    % La base de données contenant des entrées bibliographiques. Seules celles référencées dans le texte seront ajoutées \`a la bibliographie.


%
% ----------  A N N E X E S  ----------
%

%%% Enlever le commentaire de \appendix pour faire vos annexes.
%%% Les annexes sont ensuites faites comme un chapitre normal : \chapter{nom_de_l'annexe}.
\appendix
\input{appendix}
%\chapter{Le titre}
%
%\section{Section un de l'annexe A}
%
%La premi\`ere annexe du document.
%
%Pour plus de renseignements, consultez le site \href{http://www.fesp.umontreal.ca}{web de la FESP}.
%\begin{table}[htb]
%	\renewcommand{\arraystretch}{1.25}
%	\newcommand{\dotrule}[1]{\parbox[t]{#1}{\dotfill}}
%	\centering
%	\caption[Titre alternatif pour la table des mati\`eres]{Liste des parties}
%	\label{tab:parties}
%	\begin{tabular}{p{0.6\textwidth}@{\hspace{0.15\textwidth}}p{0.15\textwidth}}
%		\hline\hline & \\[-3mm]
%  		Les couvertures conformes 											& obligatoires			\\
%		Les pages de garde 													& obligatoires			\\
%		La page de titre 													& obligatoire			\\
%		Le résumé en français et les mots clés français						& obligatoires			\\
%		Le résumé en anglais et les mots clés anglais 						& obligatoires			\\
%		Le résumé de vulgarisation											& facultatif			\\
%		La table des mati\`eres, la liste des tableaux, la liste des figures 	& obligatoires			\\
%		La liste des sigles, la liste des abréviations						& obligatoires			\\
%		La dédicace															& facultative			\\
%		Les remerciements 													& facultatifs			\\
%		L'avant-propos 														& facultatif			\\
%		Le corps de l'ouvrage												& obligatoire			\\
%		L'index analytique													& facultatif			\\
%		Les sources documentaires 											& obligatoires			\\
%		Les appendices (annexes) 											& facultatifs			\\
%		Le curriculum vit\ae{}												& facultatif			\\
%		Les documents spéciaux 												& facultatifs			\\
%		[3mm] \hline\hline
%	\end{tabular}
%\end{table}
%Pour plus de renseignements, consultez le site \href{http://www.fesp.umontreal.ca}{web de la FESP}.
%
%\chapter{Le titre2}
%\chapter{Le titre3}
%\chapter{Le titre4}

\end{document}
